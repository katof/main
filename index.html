<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ITDD Aarhus ‚Äì Hvem er jeg?</title>
  <style>
    /* --- Scoped styles: nothing leaks outside .itdd-game --- */
    .itdd-game{--bg:#0b0b10;--panel:#11131a;--panel-2:#171a22;--text:#ffffff;--muted:#9aa3b2;--accent:#6ee7b7;--wrong:#ff8da1;--ring:#2a2f3a;--focus:#93c5fd;font:16px/1.5 system-ui,Segoe UI,Roboto,Inter,Arial;color:var(--text)}
    .itdd-game *{box-sizing:border-box}
    .itdd-game .wrap{max-width:880px;margin:32px auto;padding:20px;background:linear-gradient(180deg,#0b0b10,#0e1016);border-radius:18px}
    .itdd-game .card{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid var(--ring);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .itdd-game header{display:flex;align-items:center;justify-content:space-between;padding:16px 18px;border-bottom:1px solid var(--ring);gap:12px}
    .itdd-game header h1{font-size:22px;margin:0;letter-spacing:.2px}
    .itdd-game header .tag{font-size:12px;color:var(--muted);background:#0d0f15;border:1px solid var(--ring);padding:4px 8px;border-radius:999px;white-space:nowrap}
    .itdd-game .panel{padding:18px}
    .itdd-game .muted{color:var(--muted)}
    .itdd-game .row{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .itdd-game .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
    .itdd-game .btn{appearance:none;border:1px solid var(--ring);background:#0f1218;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:650}
    .itdd-game .btn:hover{background:#111622}
    .itdd-game .btn:disabled{opacity:.55;cursor:not-allowed}
    .itdd-game .btn.primary{background:var(--text);color:#0b0b10;border-color:transparent}
    .itdd-game .btn.primary:hover{filter:brightness(.93)}
    .itdd-game .btn.ghost{background:transparent}
    .itdd-game .kpi{font-size:14px;color:var(--muted)}
    .itdd-game .kpi b{color:var(--text)}
    .itdd-game .q h3{margin:12px 0 8px}
    .itdd-game ul.punkter{margin:0;padding:0 0 0 22px}
    .itdd-game ul.punkter li{margin:4px 0}
    .itdd-game .opt{border:1px solid var(--ring);padding:10px 12px;border-radius:12px;background:#0e1118;color:var(--text);font-weight:700;cursor:pointer;text-align:center}
    .itdd-game .opt:hover{background:#10131b}
    .itdd-game .opt[aria-selected="true"], .itdd-game .opt:focus{outline:2px solid var(--focus);outline-offset:2px}
    .itdd-game .opt.correct{border-color:#1faa84;background:rgba(110,231,183,.12)}
    .itdd-game .opt.wrong{border-color:#d23c57;background:rgba(255,141,161,.12)}
    .itdd-game .feedback{min-height:22px;font-weight:800}
    .itdd-game footer{padding:12px 18px;border-top:1px solid var(--ring);display:flex;justify-content:space-between;align-items:center}
    .itdd-game .progress{height:8px;background:#0f1117;border-radius:999px;overflow:hidden;border:1px solid var(--ring)}
    .itdd-game .bar{height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#6ee7b7);transition:width .35s ease}
    .itdd-game .controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .itdd-game .switch{display:inline-flex;align-items:center;gap:8px;font-size:14px}
    .itdd-game .switch input{appearance:none;width:38px;height:22px;border-radius:999px;background:#11131a;border:1px solid var(--ring);position:relative;outline:none;cursor:pointer}
    .itdd-game .switch input:checked{background:#164e3f}
    .itdd-game .switch input::after{content:"";position:absolute;top:2px;left:2px;width:18px;height:18px;border-radius:999px;background:#cbd5e1;transition:transform .2s ease}
    .itdd-game .switch input:checked::after{transform:translateX(16px);background:#a7f3d0}
    /* mini confetti */
    .itdd-game .confetti{position:fixed;left:50%;top:80px;pointer-events:none}
    .itdd-game .confetti span{position:absolute;animation:fall 1.2s ease-in forwards}
    @keyframes fall{to{transform:translate(var(--x,0), 180px) rotate(340deg);opacity:0}}
    .itdd-game .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    @media (max-width:560px){.itdd-game .grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="itdd-game">
    <div class="wrap card" role="application" aria-labelledby="title">
      <header>
        <h1 id="title">ITDD Aarhus ‚Äì Hvem er jeg?</h1>
        <span class="tag">G√¶t & l√¶r</span>
      </header>

      <div class="panel">
        <p class="muted" id="intro">Klik <b>Start</b>, l√¶s tre <b>punkter</b>, og v√¶lg personen. √ât point pr. rigtigt svar.</p>
        <div class="row">
          <div class="controls" aria-label="Indstillinger">
            <label class="switch"><input id="hard" type="checkbox" aria-label="Sv√¶r tilstand">Sv√¶r tilstand</label>
            <button id="shuffleBtn" class="btn ghost" type="button" title="Bland r√¶kkef√∏lgen">üîÄ Bland</button>
            <label class="switch"><input id="autoNext" type="checkbox" aria-label="G√• automatisk videre" checked>Auto‚Äën√¶ste</label>
          </div>
          <button id="start" class="btn primary" type="button">Start</button>
        </div>
        <div class="progress" aria-hidden="true" style="margin-top:10px"><div id="bar" class="bar"></div></div>
      </div>

      <div id="game" class="panel" hidden>
        <div class="row kpi" aria-live="polite">
          <div>Runde <b id="round">1</b>/<span id="total">4</span></div>
          <div>Point: <b id="score">0</b> &middot; Bedste: <b id="best">0</b></div>
        </div>

        <div class="q">
          <h3>Hvem beskrives af disse <b>punkter</b>?</h3>
          <ul id="punkter" class="punkter" aria-describedby="punkterhelp"></ul>
          <span id="punkterhelp" class="sr-only">Tre korte punkter, g√¶t hvilken person de beskriver.</span>
        </div>

        <div id="options" class="grid" role="listbox" aria-label="Mulige personer"></div>

        <div class="row" style="margin-top:10px">
          <div id="feedback" class="feedback" aria-live="polite"></div>
          <div class="controls">
            <button id="hint" class="btn ghost" type="button" title="Vis et hint">üí° Hint</button>
            <button id="next" class="btn" type="button" disabled>N√¶ste</button>
          </div>
        </div>
      </div>

      <footer>
        <small class="muted">G√¶t hvem vi er!</small>
        <small class="muted">Lavet af 4√ò4‚Äëholdet ‚ú®</small>
      </footer>
    </div>

    <div id="confetti" class="confetti" aria-hidden="true"></div>
  </div>

  <script>
    // DATA ‚Äì kun "punkter"
    const PEOPLE = [
      { id: "ditte", navn: "Ditte", punkter: [
          "Jeg er uddannet l√¶rer og har v√¶ret klassel√¶rer.",
          "Jeg dr√∏mmer om at kombinere p√¶dagogik med IT‚Äëdidaktik.",
          "Jeg elsker at lave mad ‚Äì og n√∏rder tilbudsaviser!",
        ] },
      { id: "maya", navn: "Maya", punkter: [
          "Jeg bor i Kolding med k√¶reste og datter.",
          "Jeg er socialp√¶dagog ‚Äì nu ITDD‚Äëstuderende.",
          "Jeg elsker mad, men hader at lave det.",
        ] },
      { id: "karina", navn: "Karina", punkter: [
          "Jeg bor p√• F√¶r√∏erne og arbejder som redakt√∏r.",
          "Jeg n√∏rder l√¶ring ‚Äì fra mikrobiologi til krigsstrategi.",
          "N√•r det kommer til mad, er jeg ret afslappet ‚Äì alt er godt!",
        ] },
      { id: "bruno", navn: "Bruno", punkter: [
          "Jeg samler vinyl og g√¶ster ofte festivaler og koncerter.",
          "Jeg taler i h√∏jttalerne p√• BK FREM‚Äôs stadion.",
          "Jeg arbejder som digitaliseringskonsulent.",
        ] },
    ];

    // Utils
    const $ = (q, el=document) => el.querySelector(q);
    const $$ = (q, el=document) => [...el.querySelectorAll(q)];
    const shuffle = (arr) => arr.map(v => [Math.random(), v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);
    const sample = (arr, n) => shuffle(arr).slice(0, n);

    // State
    let rounds = [];
    let step = 0;
    let score = 0;
    let best = Number(localStorage.getItem('bestScore')||0);
    let autoTimer = null;

    // DOM refs
    const startBtn = $('#start');
    const shuffleBtn = $('#shuffleBtn');
    const game = $('#game');
    const roundEl = $('#round');
    const totalEl = $('#total');
    const scoreEl = $('#score');
    const bestEl = $('#best');
    const punkterEl = $('#punkter');
    const optionsEl = $('#options');
    const feedbackEl = $('#feedback');
    const nextBtn = $('#next');
    const hintBtn = $('#hint');
    const confetti = $('#confetti');
    const hardToggle = $('#hard');
    const autoNextToggle = $('#autoNext');
    const bar = $('#bar');

    bestEl.textContent = best;

    function startGame(){
      rounds = shuffle(PEOPLE);
      step = 0; score = 0; clearTimeout(autoTimer);
      totalEl.textContent = rounds.length;
      scoreEl.textContent = score;
      $('#intro').hidden = true;
      startBtn.disabled = true;
      game.hidden = false;
      setBar();
      renderRound();
    }

    function setBar(){
      const pct = rounds.length ? (step/rounds.length)*100 : 0;
      bar.style.width = pct + '%';
    }

    function renderRound(){
      const current = rounds[step];
      roundEl.textContent = step + 1;
      feedbackEl.textContent = '';
      nextBtn.disabled = true;

      // vis punkter (evt. sv√¶r tilstand: bland og vis 2 af 3)
      punkterEl.innerHTML = '';
      let pts = [...current.punkter];
      if(hardToggle.checked){ pts = shuffle(pts).slice(0,2); }
      pts.forEach(p => { const li = document.createElement('li'); li.textContent = p; punkterEl.appendChild(li); });

      // lav svarmuligheder (s√∏rg for at current er inkluderet)
      const others = PEOPLE.filter(p => p.id !== current.id);
      const opts = shuffle([current, ...sample(others, Math.min(3, others.length))]).slice(0, Math.min(4, PEOPLE.length));

      optionsEl.innerHTML = '';
      opts.forEach((o, i) => {
        const btn = document.createElement('button');
        btn.className = 'opt';
        btn.role = 'option';
        btn.setAttribute('data-id', o.id);
        btn.setAttribute('aria-label', o.navn + ', mulighed ' + (i+1));
        btn.textContent = `${i+1}. ${o.navn}`;
        btn.addEventListener('click', () => pick(o.id, btn, current.id));
        btn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); btn.click(); }});
        optionsEl.appendChild(btn);
      });
      // Ikke auto‚Äëfocus f√∏rste navn (s√• ingen "random" kant p√• fx Karina)
    }

    function pick(id, el, correctId){
      // l√•s flere valg
      $$('.opt').forEach(b => { b.disabled = true; b.setAttribute('aria-disabled','true'); });

      clearTimeout(autoTimer);
      const isCorrect = id === correctId;
      if(isCorrect){
        el.classList.add('correct');
        el.setAttribute('aria-selected','true');
        feedbackEl.textContent = 'Korrekt! üéâ';
        score++; scoreEl.textContent = score; setBar();
        burst();
      } else {
        el.classList.add('wrong');
        feedbackEl.textContent = 'Ikke helt‚Ä¶';
        $$('.opt').find(b => b.dataset.id === correctId)?.classList.add('correct');
      }
      nextBtn.disabled = false;

      // Auto‚Äën√¶ste efter kort pause (hvis sl√•et til)
      if(autoNextToggle.checked){
        autoTimer = setTimeout(next, isCorrect ? 900 : 1100);
      } else {
        nextBtn.focus();
      }
    }

    function next(){
      clearTimeout(autoTimer);
      if(step < rounds.length - 1){
        step++; setBar(); renderRound();
      } else {
        // slutsk√¶rm
        optionsEl.innerHTML = '';
        punkterEl.innerHTML = '';
        feedbackEl.textContent = '';
        const done = document.createElement('div');
        done.innerHTML = `<h3>F√¶rdig! üëè</h3><p class="muted">Din score: <b>${score}</b> / ${rounds.length}</p>`;
        optionsEl.appendChild(done);
        nextBtn.disabled = true;
        const again = document.createElement('button');
        again.className = 'btn primary';
        again.textContent = 'Spil igen';
        again.addEventListener('click', resetToIntro);
        optionsEl.appendChild(again);
        if(score > best){ best = score; localStorage.setItem('bestScore', String(best)); bestEl.textContent = best; }
      }
    }

    function resetToIntro(){
      $('#intro').hidden=false; startBtn.disabled=false; game.hidden=true; bar.style.width='0%';
    }

    function hint(){
      const current = rounds[step];
      const initials = current.navn.trim().split(' ').filter(Boolean).map(n=>n[0]).join('.') + '.';
      feedbackEl.textContent = `Hint: Initialer = ${initials}`;
    }

    function burst(){
      confetti.innerHTML = '';
      const icons = ['üéâ','‚ú®','üéà','ü•≥'];
      for(let i=0;i<14;i++){
        const s = document.createElement('span');
        s.textContent = icons[i % icons.length];
        s.style.left = (Math.random()*120 - 60) + 'px';
        s.style.setProperty('--x', (Math.random()*200 - 100) + 'px');
        s.style.animationDelay = (Math.random()*0.1) + 's';
        confetti.appendChild(s);
        setTimeout(()=>s.remove(), 1400);
      }
    }

    // Keyboard‚Äëgenveje: 1‚Äë4 v√¶lger, Enter g√•r videre
    window.addEventListener('keydown', (e)=>{
      if(e.key>='1' && e.key<='4'){
        const idx = Number(e.key)-1; const btn = $$('.opt')[idx]; if(btn && !btn.disabled){ btn.click(); }
      } else if(e.key==='Enter'){
        if(!game.hidden && !nextBtn.disabled){ next(); }
        else if(startBtn && !startBtn.disabled){ startGame(); }
      }
    });

    // Events
    startBtn.addEventListener('click', startGame);
    shuffleBtn.addEventListener('click', ()=>{ rounds = shuffle(PEOPLE); if(!game.hidden){ step=0; renderRound(); } });
    nextBtn.addEventListener('click', next);
    hintBtn.addEventListener('click', hint);
  </script>
</body>
</html>
